<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta-name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NADI AI - Health Simulation (All-Rounder)</title>
  <style>
    :root {
      --gold: #ffcc00;
      --dark: #101010;
      --gray: #222;
    }
    body {
      background: var(--dark);
      color: white;
      font-family: "Poppins", sans-serif;
      text-align: center;
      margin: 0;
      padding: 20px;
    }
    h1 { color: var(--gold); margin-bottom: 10px; }
    .controls {
      display:flex;
      gap:10px;
      justify-content:center;
      align-items:center;
      margin-bottom:12px;
      flex-wrap:wrap;
    }
    select, button {
      background: var(--gold);
      color: black;
      font-weight: 600;
      padding: 10px 12px;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      font-size: 14px;
      transition: 0.2s;
    }
    select { padding: 8px 10px; }
    button:hover { background: #fff15c; }
    .report {
      background: var(--gray);
      padding: 20px;
      margin: 20px auto;
      border-radius: 15px;
      max-width: 520px;
      box-shadow: 0 0 15px rgba(255, 215, 0, 0.2);
    }
    .highlight { color: var(--gold); font-weight: bold; }
    .row {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
    }
    .card {
      background: #1c1c1c;
      padding: 12px;
      border-radius: 10px;
      min-width: 140px;
      text-align: center;
      flex-grow: 1;
    }

    /* Vibrant recommended ranges */
    .rec {
      font-size: 12px;
      font-weight: 700;
      margin-top: 6px;
      background: linear-gradient(90deg, #00eaff, #34ffdd);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      text-shadow: 0 0 8px rgba(0, 255, 255, 0.35);
    }

    .conditions {
      margin-top: 8px;
      background: #1c1c1c;
      border-radius: 10px;
      padding: 10px;
    }

    .dosha {
      margin-top:10px;
      padding:12px;
      border-radius:10px;
      background: linear-gradient(135deg, rgba(0,255,204,0.03), rgba(255,204,0,0.02));
      box-shadow: 0 0 12px rgba(0,255,204,0.03);
      text-align:left;
    }
    .dosha h3 { color: #00ffcc; margin:0 0 6px 0; }
    .dosha p { margin:4px 0; color:#ddd; font-size:14px; }
    small.note { color:#bbb; display:block; margin-top:8px; }
  </style>
</head>
<body>

<h1>üß† NADI AI - Health Simulation (All-Rounder)</h1>

<div class="controls">
  <!-- Dropdown gender selector as requested -->
  <label for="genderSelect" style="font-size:14px;color:#ddd;margin-right:6px">Gender:</label>
  <select id="genderSelect" aria-label="Select gender">
    <option value="">-- Select or leave --</option>
    <option value="male">Male</option>
    <option value="female">Female</option>
    <option value="other">Other</option>
  </select>

  <button onclick="startScan()">Start Simulation / ‡Æ§‡Øä‡Æü‡Æô‡Øç‡Æï‡ØÅ</button>
</div>

<!-- QUICK VIEW -->
<div id="reportSmall" class="report">
  <h3 style="color:var(--gold)">Quick View / ‡Æµ‡Æø‡Æ∞‡Øà‡Æµ‡ØÅ ‡Æï‡Ææ‡Æü‡Øç‡Æö‡Æø</h3>
  <p>Gender: <span id="qGender" class="highlight">--</span></p>
  <p>Age: <span id="qAge" class="highlight">--</span></p>

  <p>BMP Level: <span id="qBmp" class="highlight">-- mmol/L</span></p>
  <p class="rec">All-rounder: 60‚Äì100 mmol/L</p>

  <p>Blood Group: <span id="qBlood" class="highlight">--</span></p>
  <p>Pregnancy: <span id="qPreg" class="highlight">--</span></p>

  <p>Pulse: <span id="qPulse" class="highlight">-- bpm</span></p>
  <p class="rec" id="qPulseRec">Normal: 60‚Äì100 bpm</p>

  <p>Pressure: <span id="qPress" class="highlight">--/-- mmHg</span></p>
  <p class="rec" id="qPressRec">Normal: 120/80 mmHg</p>

  <p>Stress: <span id="qStress" class="highlight">--</span></p>

  <p>Diabetes Risk: <span id="qDiab" class="highlight">--%</span></p>
  <p>Heart Attack Risk: <span id="qHeart" class="highlight">--%</span></p>

  <p>SpO‚ÇÇ: <span id="qSpo2" class="highlight">--%</span></p>
  <p class="rec" id="qSpo2Rec">95‚Äì100%</p>

  <p>Hemoglobin: <span id="qHemo" class="highlight">-- g/dL</span></p>
  <p class="rec" id="qHemoRec">M: 13.5‚Äì17.5 | F: 12.0‚Äì15.5</p>

  <p>WBC: <span id="qWbc" class="highlight">-- /¬µL</span></p>
  <p class="rec" id="qWbcRec">4500‚Äì11000 /¬µL</p>

  <p>RBC: <span id="qRbc" class="highlight">-- million/¬µL</span></p>
  <p class="rec" id="qRbcRec">M: 4.7‚Äì6.1 | F: 4.2‚Äì5.4</p>

  <p>Blood Cancer Risk: <span id="qCancer" class="highlight">--%</span></p>
</div>

<!-- FULL REPORT -->
<div id="reportFull" class="report" style="display:none">
  <div id="primaryConditionBox" style="display:none">
    <b>Primary Condition (Simulation):</b> <span id="primaryCondText">--</span>
  </div>

  <h2>AI Health Report / ‡Æê‡Æè ‡Æö‡ØÅ‡Æï‡Ææ‡Æ§‡Ææ‡Æ∞ ‡ÆÖ‡Æ±‡Æø‡Æï‡Øç‡Æï‡Øà</h2>

  <div class="row">
    <div class="card">Gender: <span id="genderVal" class="highlight">--</span></div>
    <div class="card">Age: <span id="ageVal" class="highlight">--</span></div>
    <div class="card">BMP Level: <span id="bmpVal" class="highlight">-- mmol/L</span>
      <div class="rec">60‚Äì100 mmol/L</div>
    </div>
    <div class="card">Blood Group: <span id="bloodVal" class="highlight">--</span></div>
  </div>

  <div class="row" style="margin-top:12px">
    <div class="card">Pulse Rate: <span id="pulseVal" class="highlight">-- bpm</span>
      <div class="rec" id="pulseRecCard">60‚Äì100 bpm</div>
    </div>
    <div class="card">Pressure: <span id="pressVal" class="highlight">--/-- mmHg</span>
      <div class="rec" id="pressRecCard">120/80 mmHg</div>
    </div>
    <div class="card">Stress Level: <span id="stressVal" class="highlight">--</span></div>
  </div>

  <div class="row" style="margin-top:12px">
    <div class="card">Diabetes Risk: <span id="diabVal" class="highlight">--%</span></div>
    <div class="card">Heart Attack Risk: <span id="heartVal" class="highlight">--%</span></div>
  </div>

  <div class="row" style="margin-top:12px">
    <div class="card">SpO‚ÇÇ: <span id="spo2Val" class="highlight">--%</span>
      <div class="rec" id="spo2RecCard">95‚Äì100%</div>
    </div>
    <div class="card">Hemoglobin: <span id="hemoVal" class="highlight">-- g/dL</span>
      <div class="rec" id="hemoRecCard">M: 13.5‚Äì17.5 | F: 12.0‚Äì15.5</div>
    </div>
  </div>

  <div class="row" style="margin-top:12px">
    <div class="card">WBC Count: <span id="wbcVal" class="highlight">-- /¬µL</span>
      <div class="rec" id="wbcRecCard">4500‚Äì11000 /¬µL</div>
    </div>
    <div class="card">RBC Count: <span id="rbcVal" class="highlight">-- million/¬µL</span>
      <div class="rec" id="rbcRecCard">M: 4.7‚Äì6.1 | F: 4.2‚Äì5.4</div>
    </div>
  </div>

  <div class="row" style="margin-top:12px">
    <div class="card">Blood Cancer Risk: <span id="cancerVal" class="highlight">--%</span></div>
  </div>

  <p id="aiObs">AI Observation: <span class="highlight">--</span></p>
  <p id="advice">Suggestion: <span class="highlight">--</span></p>

  <h3 style="margin:6px 0;color:var(--gold)">Possible Conditions (Simulation)</h3>
  <div class="conditions" id="conditionsList"></div>

  <div class="dosha" id="doshaBox" style="display:none">
    <h3>Ayurvedic Diagnostic (Professional)</h3>
    <p id="doshaPrimary"><strong>Primary:</strong> ‚Äî</p>
    <p id="doshaDetails"><strong>Details:</strong> ‚Äî</p>
    <small class="note">This is a simulated Ayurvedic interpretation for educational/demo purposes only.</small>
  </div>
</div>

<script>
function startScan() {
  // show full report container
  document.getElementById('reportFull').style.display = "block";

  // Read gender from dropdown
  const genderSelect = document.getElementById('genderSelect');
  let gender = genderSelect.value || null;

  // AGE prompt
  let ageInput = prompt("Enter age (years): leave blank to skip:");
  let age = null;
  if (ageInput !== null && ageInput.trim() !== "") {
    const parsed = parseInt(ageInput.trim());
    if (!isNaN(parsed) && parsed > 0) age = parsed;
    else {
      alert("Invalid age entered ‚Äî ignoring age.");
      age = null;
    }
  }

  // Pregnancy prompt if female
  let pregnancy = null;
  if (gender === "female") {
    let wantPreg = prompt("Need pregnancy info? (yes / no) ‚Äî leave blank to skip:");
    if (wantPreg) {
      wantPreg = wantPreg.trim().toLowerCase();
      pregnancy = (wantPreg === "yes");
    }
  } else {
    // If gender not selected or other, optionally ask if want to supply pregnancy
    // keep pregnancy null unless explicitly asked
  }

  const pregText = pregnancy === true ? (Math.random() < 0.5 ? 'Positive / ‡Æ®‡Øá‡Æ∞‡Øç‡ÆÆ‡Æ±‡Øà' : 'Negative / ‡Æé‡Æ§‡Æø‡Æ∞‡Øç‡ÆÆ‡Æ±‡Øà') : null;

  // === EXISTING SIMULATED VALUES (kept original logic) ===
  const bmp = (Math.random() * 40 + 60).toFixed(1);
  const bloodGroups = ['A+', 'A-', 'B+', 'B-', 'AB+', 'AB-', 'O+', 'O-'];
  const blood = bloodGroups[Math.floor(Math.random() * bloodGroups.length)];
  const pulse = Math.floor(Math.random() * 40 + 60); // 60-99
  const stressLevels = ['Low', 'Medium', 'High'];
  const stress = stressLevels[Math.floor(Math.random() * stressLevels.length)];
  const pressSys = Math.floor(Math.random() * 40 + 90); // 90-129
  const pressDia = Math.floor(Math.random() * 30 + 60); // 60-89
  const diabRisk = Math.floor(Math.random() * 60 + 10);
  const heartRisk = Math.min(98, Math.max(3, Math.round(diabRisk * 0.85 + Math.random() * 10)));

  // NEW FAKE BLOOD VALUES (kept style)
  const spo2 = Math.floor(Math.random() * 6 + 94); // 94‚Äì99
  const hemoglobin = (Math.random() * 4 + 11).toFixed(1); // 11‚Äì15
  const wbc = Math.floor(Math.random() * 6000 + 4000); // 4000‚Äì10000
  const rbc = (Math.random() * 2 + 4).toFixed(2); // 4‚Äì6
  const cancerRisk = Math.floor(Math.random() * 20); // 0‚Äì19%

  const conditions = ['Normal', 'Mild Hypertension', 'Anxiety', 'High Stress', 'Good Health'];
  const condition = conditions[Math.floor(Math.random() * conditions.length)];
  const observation = condition === 'Good Health'
    ? 'All vitals are stable.'
    : `Detected signs of ${condition.toLowerCase()}.`;
  const suggestion = condition === 'Good Health'
    ? 'Maintain a balanced diet and regular exercise.'
    : 'Consult a physician for further evaluation.';

  // === Determine All-Rounder recommended ranges based on age + gender ===
  // defaults (all-rounder)
  let rec = {
    pulse: "60‚Äì100 bpm",
    spo2: "95‚Äì100%",
    hemo: "M: 13.5‚Äì17.5 | F: 12.0‚Äì15.5 g/dL",
    wbc: "4500‚Äì11000 /¬µL",
    rbc: "M: 4.7‚Äì6.1 | F: 4.2‚Äì5.4 million/¬µL",
    press: "120/80 mmHg",
    bmp: "60‚Äì100 mmol/L"
  };

  // fine-tune by age groups and gender per all-rounder model
  if (age !== null) {
    if (age <= 12) {
      rec.pulse = "70‚Äì120 bpm";
      rec.spo2 = "95‚Äì100%";
      rec.hemo = "11‚Äì13 g/dL";
      rec.wbc = "5000‚Äì15000 /¬µL";
      rec.rbc = "4.0‚Äì5.2 million/¬µL";
    } else if (age <= 19) {
      rec.pulse = "60‚Äì100 bpm";
      rec.spo2 = "95‚Äì100%";
      rec.hemo = (gender === "male" ? "13‚Äì16 g/dL" : "12‚Äì15 g/dL");
      rec.wbc = "4500‚Äì11000 /¬µL";
      rec.rbc = (gender === "male" ? "4.7‚Äì5.9" : "4.2‚Äì5.4");
    } else if (age <= 40) {
      rec.pulse = (gender === "male" ? "60‚Äì90 bpm" : "65‚Äì95 bpm");
      rec.spo2 = "95‚Äì100%";
      rec.hemo = (gender === "male" ? "13.5‚Äì17.5 g/dL" : "12.0‚Äì15.5 g/dL");
      rec.wbc = "4500‚Äì11000 /¬µL";
      rec.rbc = (gender === "male" ? "4.7‚Äì6.1" : "4.2‚Äì5.4");
    } else if (age <= 60) {
      rec.pulse = (gender === "male" ? "60‚Äì95 bpm" : "65‚Äì100 bpm");
      rec.spo2 = "95‚Äì100%";
      rec.hemo = (gender === "male" ? "13.5‚Äì17.5 g/dL" : "12.0‚Äì15.5 g/dL");
      rec.wbc = "4500‚Äì11000 /¬µL";
      rec.rbc = (gender === "male" ? "4.7‚Äì6.1" : "4.2‚Äì5.4");
    } else {
      // 60+
      rec.pulse = (gender === "male" ? "60‚Äì100 bpm" : "65‚Äì105 bpm");
      rec.spo2 = "92‚Äì98%";
      rec.hemo = (gender === "male" ? "13‚Äì17 g/dL" : "11.5‚Äì15 g/dL");
      rec.wbc = "4500‚Äì11000 /¬µL";
      rec.rbc = (gender === "male" ? "4.5‚Äì5.8" : "4.0‚Äì5.3");
    }
  } else {
    // age unknown -> keep universal rec values (already set)
    if (gender === "male") {
      rec.hemo = "13.5‚Äì17.5 g/dL";
      rec.rbc = "4.7‚Äì6.1 million/¬µL";
    } else if (gender === "female") {
      rec.hemo = "12.0‚Äì15.5 g/dL";
      rec.rbc = "4.2‚Äì5.4 million/¬µL";
    }
  }

  // === Update QUICK VIEW ===
  document.getElementById('qGender').textContent = gender ?? "--";
  document.getElementById('qAge').textContent = age ?? "--";
  document.getElementById('qPreg').textContent = pregText ?? "--";
  document.getElementById('qBmp').textContent = bmp + " mmol/L";
  document.getElementById('qBlood').textContent = blood;
  document.getElementById('qPulse').textContent = pulse + " bpm";
  document.getElementById('qPress').textContent = pressSys + "/" + pressDia + " mmHg";
  document.getElementById('qStress').textContent = stress;
  document.getElementById('qDiab').textContent = diabRisk + "%";
  document.getElementById('qHeart').textContent = heartRisk + "%";

  document.getElementById('qSpo2').textContent = spo2 + "%";
  document.getElementById('qHemo').textContent = hemoglobin + " g/dL";
  document.getElementById('qWbc').textContent = wbc + " /¬µL";
  document.getElementById('qRbc').textContent = rbc + " million/¬µL";
  document.getElementById('qCancer').textContent = cancerRisk + "%";

  // set quick-view rec texts
  document.getElementById('qPulseRec').textContent = "Normal: " + rec.pulse;
  document.getElementById('qPressRec').textContent = "Normal: " + rec.press;
  document.getElementById('qSpo2Rec').textContent = rec.spo2;
  document.getElementById('qHemoRec').textContent = rec.hemo;
  document.getElementById('qWbcRec').textContent = rec.wbc;
  document.getElementById('qRbcRec').textContent = rec.rbc;

  // === Update FULL REPORT ===
  document.getElementById('genderVal').textContent = gender ?? "--";
  document.getElementById('ageVal').textContent = age ?? "--";
  document.getElementById('pregVal').textContent = pregText ?? "--";
  document.getElementById('bmpVal').textContent = bmp + " mmol/L";
  document.getElementById('bloodVal').textContent = blood;
  document.getElementById('pulseVal').textContent = pulse + " bpm";
  document.getElementById('pressVal').textContent = pressSys + "/" + pressDia + " mmHg";
  document.getElementById('stressVal').textContent = stress;
  document.getElementById('diabVal').textContent = diabRisk + "%";
  document.getElementById('heartVal').textContent = heartRisk + "%";

  document.getElementById('spo2Val').textContent = spo2 + "%";
  document.getElementById('hemoVal').textContent = hemoglobin + " g/dL";
  document.getElementById('wbcVal').textContent = wbc + " /¬µL";
  document.getElementById('rbcVal').textContent = rbc + " million/¬µL";
  document.getElementById('cancerVal').textContent = cancerRisk + "%";

  // set full-report rec cards
  document.getElementById('pulseRecCard').textContent = rec.pulse;
  document.getElementById('pressRecCard').textContent = rec.press;
  document.getElementById('spo2RecCard').textContent = rec.spo2;
  document.getElementById('hemoRecCard').textContent = rec.hemo;
  document.getElementById('wbcRecCard').textContent = rec.wbc;
  document.getElementById('rbcRecCard').textContent = rec.rbc;

  // AI observation / suggestion
  document.getElementById('aiObs').innerHTML =
    `AI Observation: <span class="highlight">${observation}</span>`;
  document.getElementById('advice').innerHTML =
    `Suggestion: <span class="highlight">${suggestion}</span>`;
  document.getElementById('conditionsList').innerHTML = `<b>${condition}</b>`;
  document.getElementById('primaryCondText').textContent = condition;
  document.getElementById('primaryConditionBox').style.display = "block";

  // === Ayurvedic professional diagnostic (Option 3 style) ===
  // Build a detailed professional-style diagnosis using multiple vitals
  let primaryDosha = "";
  let details = [];

  // score-ish approach (simple heuristics)
  const score = {
    vata: 0,
    pitta: 0,
    kapha: 0
  };

  // pulse speed clues
  if (pulse >= 95) { score.pitta += 2; score.vata += 1; }
  else if (pulse < 65) { score.kapha += 2; score.vata += 1; }
  else { score.vata += 1; }

  // spo2 low -> pitta / vata stress on pranavayu
  if (spo2 < 94) { score.pitta += 2; score.vata += 1; details.push("Reduced SpO‚ÇÇ suggests compromised PrƒÅ·πáa (respiratory inefficiency)."); }

  // hemoglobin low -> rakta dhatu depletion
  const hemoVal = parseFloat(hemoglobin);
  if (hemoVal < 12.5) { score.kapha += 1; details.push("Hemoglobin shows relative Rakta depletion‚Äîmonitor Ojas/Rakta dhƒÅtu."); }

  // high WBC -> inflammatory / immune activation -> pitta/vata
  if (wbc > 9000) { score.vata += 1; score.pitta += 2; details.push("Elevated WBC consistent with SannipƒÅtic inflammatory activity (possible Pitta involvement)."); }

  // RBC low -> tissue dryness / vata
  if (parseFloat(rbc) < 4.5) { score.vata += 2; details.push("RBC lower side ‚Äî indicates possible VƒÅta imbalance affecting dhƒÅtus."); }

  // age influences baseline
  if (age !== null && age > 60) { score.kapha += 1; details.push("Age-related Kapha tendencies noted (reduced metabolic agni)."); }

  // gender small influence
  if (gender === "female") { score.kapha += 0.5; }

  // combine scores
  const maxScore = Math.max(score.vata, score.pitta, score.kapha);
  if (maxScore === score.vata) primaryDosha = "VƒÅta-Predominant (VƒÅta Aggravation)";
  else if (maxScore === score.pitta) primaryDosha = "Pitta-Predominant (Pitta Aggravation)";
  else primaryDosha = "Kapha-Predominant (Kapha Imbalance)";

  // professional-style explanatory block
  let doshaText = "";
  doshaText += `${primaryDosha}.`;
  doshaText += " Diagnostic rationale: ";
  if (details.length === 0) {
    doshaText += "Present vitals suggest relatively balanced tridosha with minor variations. Maintain dinacharya and observe diet.";
  } else {
    doshaText += details.join(" ");
  }
  // add suggested professional measures (concise)
  doshaText += " Recommended: Shamana interventions focusing on Agni balancing, deep tissue (DhƒÅtu) nourishment, and PrƒÅ·πáa support. For suspected inflammatory trends, consider palliative cooling measures and consult an Ayurvedic practitioner for ·πö·π£·π≠a/≈õamana plan adapted to prak·πõti.";

  // show dosha block
  document.getElementById('doshaBox').style.display = "block";
  document.getElementById('doshaPrimary').innerHTML = `<strong>Primary:</strong> ${primaryDosha}`;
  document.getElementById('doshaDetails').innerHTML = `<strong>Details:</strong> ${doshaText}`;

  // === SPEECH OUTPUT ===
  let speakText = "";
  if (gender) speakText += `Gender ${gender}. `;
  if (age) speakText += `Age ${age}. `;
  if (pregText) speakText += `Pregnancy ${pregText}. `;
  speakText += `BMP ${bmp}. Blood group ${blood}. Pulse ${pulse}. Pressure ${pressSys} over ${pressDia}. Stress ${stress}. Diabetes risk ${diabRisk} percent. Heart attack risk ${heartRisk} percent. SpO2 ${spo2} percent. Hemoglobin ${hemoglobin}. W B C ${wbc}. R B C ${rbc}. Blood cancer risk ${cancerRisk} percent. Observation: ${observation}. Suggestion: ${suggestion}. Ayurvedic assessment: ${primaryDosha}.`;

  const utter = new SpeechSynthesisUtterance(speakText);
  utter.rate = 1;
  // Try/catch because some browsers may block TTS
  try { speechSynthesis.speak(utter); } catch (e) { console.warn("Speech failed:", e); }
}
</script>

</body>
</html>

